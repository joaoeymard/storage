!function(t){"use strict";const o={invalid_storage:"Falha ao executar: O parametro 'storage' informado não é do tipo 'localStorage' ou 'sessionStorage'",invalid_key:"Chave de armazenamento ausente ou inválida",invalid_data:"Falha ao executar: O parametro informado não é do tipo 'Object' ou 'Array'",invalid_type_event:"Falha ao executar: O parametro 'type' informado não é do tipo 'String'",invalid_function_event:"Falha ao executar: O parametro 'listener' informado não é do tipo 'Function'"},e=t=>"[object Array]"===Object.prototype.toString.call(t),r=t=>"[object Object]"===Object.prototype.toString.call(t);const n=t=>"[object Function]"===Object.prototype.toString.call(t)||"[object AsyncFunction]"===Object.prototype.toString.call(t),i=t=>"[object Null]"===Object.prototype.toString.call(t)||"[object Undefined]"===Object.prototype.toString.call(t),a=t=>"[object String]"===Object.prototype.toString.call(t)&&""===t,p=JSON.parse,s=JSON.stringify;function y(t,e,...r){t.filter(t=>t.type===e).forEach(function(t){t.listener(...r)})}function c({storage:t=localStorage,key:e,expire:r}){if("[object Storage]"!==Object.prototype.toString.call(t))throw new TypeError(o.invalid_storage);if("[object String]"!==Object.prototype.toString.call(e)||i(e))throw new Error(o.invalid_key);this.setExpire(r),this._storage=t,this._key=e,this._events=[]}c.prototype.getData=function(){return!i(this._expireAt)&&this._expireAt<Date.now()&&this.clear(),this._storage.getItem(this._key)},c.prototype.getDataParsed=function(){let t=this.getData();return(i(t)||a(t))&&(t="[]"),p(t)},c.prototype.getDataArray=function(){var t=this.getDataParsed();return e(t)?t:Array(t)},c.prototype.setData=function(t){if(!r(t)&&!e(t))throw new Error(o.invalid_data);return this._storage.setItem(this._key,s(t)),y(this._events,"updated",this.getDataParsed(),this),this},c.prototype.setExpire=function(t){"[object Number]"!==Object.prototype.toString.call(t)||i(t)||(this._expireAt=Date.now()+t)},c.prototype.count=function(){var t=this.getData();if(a(t)||i(t))return 0;t=p(t);return r(t)?1:e(t)?t.length:void 0},c.prototype.clear=function(){return this._storage.removeItem(this._key),y(this._events,"reset",null,this),this},c.prototype.insert=function(){return i(arguments)||this.setData(Array.prototype.concat.apply(this.getDataParsed(),arguments)),this},c.prototype.findOneAndUpdate=function(t,e){const r=this.getDataArray();t=r.find(t);return i(t)||(Object.assign(t,e),this.setData(r)),this},c.prototype.findOneAndReplace=function(t,e){const r=this.getDataArray();t=r.findIndex(t);return t<0||(r.splice(t,1,e),this.setData(r)),this},c.prototype.findOneAndRemove=function(t){t=this.findIndex(t);return this.removeByIndex(t)},c.prototype.removeByIndex=function(r){return r<0||this.setData(this.filter((t,e)=>e!==r)),this},c.prototype.addEventListener=function(t,e){if(i(t)||a(t))throw new TypeError(o.invalid_type_event);if(!n(e))throw new TypeError(o.invalid_function_event);this._events.push({type:t,listener:e})},c.prototype.removeEventListener=function(e,r){if(i(e)||a(e))throw new TypeError(o.invalid_type_event);if(!n(r))throw new TypeError(o.invalid_function_event);this._events=this._events.filter(t=>!(t.type===e&&t.listener===r))},c.prototype.forEach=function(){return Array.prototype.forEach.apply(this.getDataArray(),arguments)},c.prototype.filter=function(){return Array.prototype.filter.apply(this.getDataArray(),arguments)},c.prototype.find=function(){return Array.prototype.find.apply(this.getDataArray(),arguments)},c.prototype.findIndex=function(){return Array.prototype.findIndex.apply(this.getDataArray(),arguments)},c.prototype.map=function(){return Array.prototype.map.apply(this.getDataArray(),arguments)},c.prototype.sort=function(){return Array.prototype.sort.apply(this.getDataArray(),arguments)},c.prototype.reduce=function(){return Array.prototype.reduce.apply(this.getDataArray(),arguments)},t.Storage=c}(window);